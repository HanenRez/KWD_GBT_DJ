{% extends "base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">



      <!-- SVG personnage (inline si disponible) -->
      {% if svg_machhad %}
        <div class="svg_machhad svg-inline">
          {{ svg_machhad|safe }}
        </div>
      {% elif niveau.illustration %}
        <img class="svg_machhad" src="{{ svgniveau.illustration.url }}" alt="Personnage">
      {% endif %}

 

  <!-- audio global (pour lecture au survol/clic) -->
  <audio id="global-player" preload="none"></audio>



<script>
/* JS simple pour :
   - attacher events sur les éléments SVG par id/class (si inline)
   - lecture audio au survol (hover) pour éléments ciblés
   - clic sur zones déclenche actions
*/
(function(){
  const player = document.getElementById('global-player');

  function attachSVGHandlers(wrapperSelector){
    const wrapper = document.querySelector(wrapperSelector);
    if(!wrapper) return;

    const svgs = wrapper.querySelectorAll('svg');
    svgs.forEach(svg=>{
      
      // IMPORTANT : ne cibler que les éléments voulus
      const clickable = svg.querySelectorAll('.clickable, [data-action]');
      
      clickable.forEach(el=>{
        
        // curseur seulement pour les zones interactives
        el.addEventListener('mouseenter', ()=>{
          el.style.cursor = "pointer";
          const audioSrc = el.getAttribute('data-audio') || el.getAttribute('data-sound');
          if(audioSrc){
            player.src = audioSrc;
            player.play().catch(()=>{});
          }
        });

        // clic → url (si présente)
        el.addEventListener('click', (ev)=>{
          ev.stopPropagation();
          const url = el.getAttribute("data-url");
          if (url){
            window.location.href = url;
          }
        });

      });
    });
  }

  attachSVGHandlers('.svg-wrapper');
})();

</script>

{% endblock %}


